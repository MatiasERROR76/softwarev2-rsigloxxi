{"ast":null,"code":"import _classCallCheck from\"C:/Users/admin/Desktop/Master/AprendiendoReact/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/admin/Desktop/Master/AprendiendoReact/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/Users/admin/Desktop/Master/AprendiendoReact/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/admin/Desktop/Master/AprendiendoReact/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import{Redirect}from'react-router-dom';import axios from'axios';import SimpleReactValidator from'simple-react-validator';import Global from'../Global';import swal from'sweetalert';import Sidebar from'./Sidebar';//validacion formulario y alertas\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CreateArticle=/*#__PURE__*/function(_Component){_inherits(CreateArticle,_Component);var _super=_createSuper(CreateArticle);function CreateArticle(){var _this;_classCallCheck(this,CreateArticle);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.url=Global.url;_this.titleRef=/*#__PURE__*/React.createRef();_this.contentRef=/*#__PURE__*/React.createRef();_this.state={article:{},status:null,selectedFile:null};_this.changeState=function(){_this.setState({article:{title:_this.titleRef.current.value,content:_this.contentRef.current.value}});_this.validator.showMessages();_this.forceUpdate();};_this.saveArticle=function(e){e.preventDefault();// Rellenar state formulario\n_this.changeState();if(_this.validator.allValid()){// Hacer una peticion http  por post para guardar articulo\naxios.post(_this.url+'save',_this.state.article).then(function(res){if(res.data.article){_this.setState({article:res.data.article,status:'waiting'});swal('Articulo creado.','El articulo fue creado exitosamente.','success');// Subir la imagen\nif(_this.state.selectedFile!==null){// Sacar el id del articulo guardado\nvar articleId=_this.state.article._id;// Crear form data y añadir fichero\nvar formData=new FormData();formData.append('file0',_this.state.selectedFile,_this.state.selectedFile.name);// Peticion ajax\naxios.post(_this.url+'upload-image/'+articleId,formData).then(function(res){if(res.data.article){_this.setState({article:res.data.article,status:'success'});}else{_this.setState({article:res.data.article,status:'failed'});}});}else{_this.setState({status:'success'});}}else{_this.setState({status:'failed'});}});}else{_this.setState({status:'failed'});_this.validator.showMessages();_this.forceUpdate();}};_this.fileChange=function(event){_this.setState({selectedFile:event.target.file[0]});console.log(_this.state);};return _this;}_createClass(CreateArticle,[{key:\"componentWillMount\",value:function componentWillMount(){this.validator=new SimpleReactValidator({messages:{required:'Este campo es requerido.'}});}},{key:\"render\",value:function render(){if(this.state.status==='success'){return/*#__PURE__*/_jsx(Redirect,{to:\"/blog\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"center\",children:[/*#__PURE__*/_jsxs(\"section\",{id:\"content\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"subheader\",children:\"Crear Articulo\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"mid-form\",onSubmit:this.saveArticle,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"title\",children:\"Titulo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",ref:this.titleRef,onChange:this.changeState}),this.validator.message('title',this.state.article.title,'required|alpha_num_space')]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"content\",children:\"Contenido\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"content\",ref:this.contentRef,onChange:this.changeState}),this.validator.message('content',this.state.article.content,'required')]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file0\",children:\"Imagen\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file0\",onChange:this.fileChange})]}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Guardar\",className:\"btn btn-success\"})]})]}),/*#__PURE__*/_jsx(Sidebar,{})]});}}]);return CreateArticle;}(Component);export default CreateArticle;","map":{"version":3,"names":["React","Component","Redirect","axios","SimpleReactValidator","Global","swal","Sidebar","CreateArticle","url","titleRef","createRef","contentRef","state","article","status","selectedFile","changeState","setState","title","current","value","content","validator","showMessages","forceUpdate","saveArticle","e","preventDefault","allValid","post","then","res","data","articleId","_id","formData","FormData","append","name","fileChange","event","target","file","console","log","messages","required","message"],"sources":["C:/Users/admin/Desktop/Master/AprendiendoReact/src/components/CreateArticle.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport SimpleReactValidator from 'simple-react-validator';\r\nimport Global from '../Global';\r\nimport swal from 'sweetalert';\r\nimport Sidebar from './Sidebar';\r\n\r\n\r\n\r\n\r\n//validacion formulario y alertas\r\n\r\nclass CreateArticle extends Component {\r\n\r\n    url = Global.url;\r\n    titleRef = React.createRef();\r\n    contentRef = React.createRef();\r\n\r\n\r\n    state = {\r\n        article: {},\r\n        status: null,\r\n        selectedFile: null\r\n    };\r\n\r\n    componentWillMount() {\r\n        this.validator = new SimpleReactValidator({\r\n            messages: {\r\n                required: 'Este campo es requerido.'\r\n            }\r\n        });\r\n    }\r\n\r\n    changeState = () => {\r\n        this.setState({\r\n            article: {\r\n                title: this.titleRef.current.value,\r\n                content: this.contentRef.current.value\r\n            }\r\n        });\r\n\r\n        this.validator.showMessages();\r\n        this.forceUpdate();\r\n       \r\n\r\n    }\r\n\r\n    saveArticle = (e) => {\r\n        e.preventDefault();\r\n\r\n        // Rellenar state formulario\r\n        this.changeState();\r\n\r\n\r\n        if (this.validator.allValid()) {\r\n\r\n\r\n            // Hacer una peticion http  por post para guardar articulo\r\n\r\n            axios.post(this.url + 'save', this.state.article)\r\n                .then(res => {\r\n                    if (res.data.article) {\r\n\r\n                        this.setState({\r\n                            article: res.data.article,\r\n                            status: 'waiting'\r\n                        });\r\n\r\n                        swal(\r\n                            'Articulo creado.',\r\n                            'El articulo fue creado exitosamente.',\r\n                            'success' \r\n                        )\r\n\r\n                        // Subir la imagen\r\n\r\n                        if (this.state.selectedFile !== null) {\r\n\r\n                            // Sacar el id del articulo guardado\r\n                            var articleId = this.state.article._id;\r\n\r\n                            // Crear form data y añadir fichero\r\n                            const formData = new FormData();\r\n\r\n                            formData.append(\r\n                                'file0',\r\n                                this.state.selectedFile,\r\n                                this.state.selectedFile.name\r\n                            );\r\n\r\n                            // Peticion ajax\r\n\r\n                            axios.post(this.url + 'upload-image/' + articleId, formData)\r\n                                .then(res => {\r\n                                    if (res.data.article) {\r\n\r\n                                        this.setState({\r\n                                            article: res.data.article,\r\n                                            status: 'success'\r\n                                        });\r\n                                    } else {\r\n                                        this.setState({\r\n                                            article: res.data.article,\r\n                                            status: 'failed'\r\n                                        });\r\n                                    }\r\n                                });\r\n\r\n\r\n                        } else {\r\n                            this.setState({\r\n                                status: 'success'\r\n                            });\r\n\r\n                        }\r\n\r\n                    } else {\r\n\r\n                        this.setState({\r\n                            status: 'failed'\r\n                        });\r\n\r\n                    }\r\n                });\r\n        } else {\r\n\r\n            this.setState({\r\n                status: 'failed'\r\n            });\r\n\r\n            this.validator.showMessages();\r\n            this.forceUpdate();\r\n        }\r\n    }\r\n\r\n\r\n    fileChange = (event) => {\r\n        this.setState({\r\n            selectedFile: event.target.file[0]\r\n        });\r\n\r\n        console.log(this.state);\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        if (this.state.status === 'success') {\r\n            return <Redirect to=\"/blog\" />;\r\n        }\r\n\r\n        return (\r\n            <div className=\"center\">\r\n                <section id=\"content\">\r\n                    <h1 className=\"subheader\">Crear Articulo</h1>\r\n\r\n\r\n                    <form className=\"mid-form\" onSubmit={this.saveArticle}>\r\n\r\n                        <div className=\"form-group\">\r\n                            <label htmlFor=\"title\">Titulo</label>\r\n                            <input type=\"text\" name=\"title\" ref={this.titleRef} onChange={this.changeState} />\r\n\r\n                            {this.validator.message('title', this.state.article.title, 'required|alpha_num_space')}\r\n\r\n\r\n                        </div>\r\n\r\n                        <div className=\"form-group\">\r\n                            <label htmlFor=\"content\">Contenido</label>\r\n                            <textarea name=\"content\" ref={this.contentRef} onChange={this.changeState} ></textarea>\r\n\r\n                            {this.validator.message('content', this.state.article.content, 'required')}\r\n\r\n                        </div>\r\n\r\n\r\n                        <div className=\"form-group\">\r\n                            <label htmlFor=\"file0\">Imagen</label>\r\n                            <input type=\"file\" name=\"file0\" onChange={this.fileChange} />\r\n                        </div>\r\n\r\n\r\n                        <input type=\"submit\" value=\"Guardar\" className=\"btn btn-success\" />\r\n\r\n                    </form>\r\n\r\n\r\n                </section>\r\n\r\n                <Sidebar />\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\n\r\nexport default CreateArticle;"],"mappings":"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"},"metadata":{},"sourceType":"module"}